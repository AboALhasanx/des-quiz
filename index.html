<!doctype html><html lang="ar" dir="rtl"><meta charset="utf-8">
<title>Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
/* â€”â€” Ø£Ø³Ø§Ø³ÙŠØ§Øª â€”â€” */
*{box-sizing:border-box;margin:0}
body{font-family:"Cairo",sans-serif;background:#eef2f5;color:#222}

/* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ */
.topbar{background:#1e88e5;color:#fff;padding:.9rem 1.2rem;display:flex;align-items:center;gap:10px}
.topbar h1{font-size:1.2rem;margin:0 auto 0 0}
.back{font-size:1.5rem;cursor:pointer;opacity:.9}
.back:hover{opacity:1}

/* Ù…Ø­ØªÙˆÙ‰ Ù…Ø±ÙƒØ²ÙŠ */
.container{max-width:700px;margin:auto;padding:24px}

/* Ø²Ø± Ø¹Ø§Ù… */
.btn{display:block;width:90%;max-width:520px;margin:12px auto;padding:.9rem;border:none;border-radius:12px;font-size:1.05rem;cursor:pointer;transition:.15s;box-shadow:0 2px 5px rgba(0,0,0,.1)}
.btn-main{background:#2ecc71;color:#fff}
.btn-main:hover{filter:brightness(1.07)}
.btn-sec{background:#6c757d;color:#fff}
.btn-sec:hover{filter:brightness(1.12)}
.btn:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}

/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
.card{background:#fff;border-radius:12px;margin-top:20px;padding:1.3rem 1.4rem;box-shadow:0 2px 6px rgba(0,0,0,.08)}
.card h4{margin-bottom:.8rem;font-size:1.05rem}

/* Ø®ÙŠØ§Ø± */
.option{display:flex;align-items:center;border:2px solid #ced4da;border-radius:10px;padding:.55rem .85rem;margin:.5rem 0;cursor:pointer;transition:.15s;font-size:.97rem}
.option input{margin-left:.6rem;cursor:pointer}
.option.selected{border-color:#000}
.option.correct {border-color:#198754;background:#d1e7dd}
.option.wrong   {border-color:#dc3545;background:#f8d7da}

/* ØµÙ†Ø¯ÙˆÙ‚ Ù†ØªÙŠØ¬Ø© */
.result-box{max-width:520px;margin:0 auto 1.5rem;padding:1.2rem;border-radius:12px;text-align:center;font-size:1.1rem;font-weight:700;box-shadow:0 2px 6px rgba(0,0,0,.08)}
.pass{background:#d1e7dd;color:#0f5132}
.fail{background:#f8d7da;color:#842029}
</style>

<body>
<div class="topbar">
  <span id="backBtn" class="back" style="display:none" onclick="renderHome()">âŸµ</span>
  <h1 id="barTitle">Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h1>
</div>

<div id="app" class="container"></div>

<script>
/* Ø±ÙˆØ§Ø¨Ø· JSON */
const COURSES={
  des   :{title:"Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/dess_quiz.json"},
  mobile:{title:"Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/mobApp_quiz.json"},
  iot   :{title:"Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø£Ø´ÙŠØ§Ø¡",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/iot_quiz.json"}
};

const tg = window.Telegram?.WebApp; if(tg) tg.expand();
const app     = document.getElementById("app");
const barTitle= document.getElementById("barTitle");
const backBtn = document.getElementById("backBtn");

let quizData=[],answers=[],reviewed=false;

/* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
function renderHome(){
  backBtn.style.display="none";
  barTitle.textContent="Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª";
  app.innerHTML=`<h2 class="fw-bold mb-4" style="text-align:center">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>`+
    Object.entries(COURSES).map(([k,v])=>
      `<button class="btn btn-main" onclick="startQuiz('${k}')">${v.title}</button>`
    ).join("");
}

function startQuiz(key){
  const {title,src}=COURSES[key];
  backBtn.style.display="block";
  barTitle.textContent=title;
  reviewed=false;
  app.innerHTML=`<div id="quiz"></div>
                 <button id="submit" class="btn btn-main mt-3" disabled>Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>`;
  fetch(src).then(r=>r.json()).then(data=>{quizData=data;renderQuestions();});
}

function renderQuestions(){
  const box=document.getElementById("quiz");
  box.innerHTML="";
  quizData.forEach((q,i)=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`<h4>${i+1}. ${q.question}</h4>`+
      q.options.map((opt,idx)=>`
        <label class="option" id="lbl-${i}-${idx}">
          <input type="radio" name="q${i}" value="${idx}"> ${opt}
        </label>`).join("");
    box.appendChild(card);
  });
}

/* Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
document.addEventListener("change",e=>{
  if(e.target.type!=="radio")return;
  const name=e.target.name;                 // Ù…Ø«Ù„ q0
  document.querySelectorAll(`input[name="${name}"]`).forEach(inp=>{
      document.getElementById(`lbl-${name.slice(1)}-${inp.value}`)
              .classList.toggle("selected",inp.checked);
  });
  answers=quizData.map((_,i)=>{
     const sel=document.querySelector(`input[name=q${i}]:checked`);
     return sel?Number(sel.value):null;
  });
  document.getElementById("submit").disabled = answers.includes(null);
});

/* Ø²Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©/Ø§Ù„ØªØµØ­ÙŠØ­ */
document.addEventListener("click",e=>{
  if(e.target.id!=="submit")return;
  if(!reviewed){
      showScore();
      e.target.textContent="ğŸ” Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ­ÙŠØ­";
      reviewed=true;
      return;
  }
  showReview();
  e.target.remove();
});

function showScore(){
  const score=answers.reduce((s,a,i)=> a===quizData[i].correct_option_id? s+1 : s ,0);
  const pass = score >= Math.ceil(quizData.length/2);
  const box  = document.createElement("div");
  box.className=`result-box ${pass?'pass':'fail'}`;
  box.innerHTML = pass
     ? `Ù…Ø¨Ø±ÙˆÙƒ! Ø¯Ø±Ø¬ØªÙƒ <span>${score}</span> Ù…Ù† <span>${quizData.length}</span>`
     : `Ø­Ø¸Ù‹Ø§ Ø£ÙˆÙØ±! Ø¯Ø±Ø¬ØªÙƒ <span>${score}</span> Ù…Ù† <span>${quizData.length}</span>`;
  app.prepend(box);
  addFooterButtons();
  window.scrollTo({top:0,behavior:"smooth"});
}

function showReview(){
  quizData.forEach((q,i)=>{
     const cor=q.correct_option_id;
     document.getElementById(`lbl-${i}-${cor}`).classList.add("correct");
     const user=answers[i];
     if(user!==cor && user!==null){
       document.getElementById(`lbl-${i}-${user}`).classList.add("wrong");
     }
  });
  addFooterButtons();            // Ù„Ù„ØªØ£ÙƒÙ‘Ø¯ Ø£Ù†Ù‡Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©
  window.scrollTo({top:0,behavior:"smooth"});
}

/* Ø£Ø²Ø±Ø§Ø± Ø±Ø¬ÙˆØ¹/Ø¥ØºÙ„Ø§Ù‚ â€“ ØªÙØ¶Ø§Ù Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© */
function addFooterButtons(){
  if(document.getElementById("footerBtns")) return;
  app.insertAdjacentHTML("beforeend",`
    <div id="footerBtns" class="text-center mt-4">
       <button class="btn btn-main mb-2" onclick="renderHome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
       <button class="btn btn-sec"  onclick="tg?tg.close():window.close()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©</button>
    </div>`);
}

/* ØªØ´ØºÙŠÙ„ */
renderHome();
</script>
</body></html>
