<!doctype html><html lang="ar" dir="rtl"><meta charset="utf-8">
<title>Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
/* ========== Ù„ÙˆØ­Ù€Ù€Ø© Ø§Ù„Ø«ÙŠÙ€Ù… ========== */
:root[data-theme="light"]{
  --bg           : #fafafa;     /* Ø®Ù„ÙÙŠØ© Ø´Ø¨Ù‡ Ø¨ÙŠØ¶Ø§Ø¡ */
  --text         : #222;
  --card-bg      : #ffffff;
  --card-border  : #e0e0e0;

  /* Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ÙŠ Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
  --primary      : #ae8912;
  --primary-hov  : #ae8912;

  --secondary    : #6c757d;
  --secondary-hov: #7a8289;

  --topbar-bg    : #ae8912;

  --option-sel   : #000;

  /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØªØµØ­ÙŠØ­ */
  --correct-bg   : #d1e7dd; --correct-bd:#198754;
  --wrong-bg     : #f8d7da; --wrong-bd :#dc3545;
}

:root[data-theme="dark"]{
  --bg           : #141414;     /* ØºØ§Ù…Ù‚ Ø¬Ø¯Ø§Ù‹ */
  --text         : #f1f1f1;
  --card-bg      : #1f1f1f;
  --card-border  : #353535;

  --primary      : #ae8912;
  --primary-hov  : #ae8912;

  --secondary    : #495057;
  --secondary-hov: #5a6268;

  --topbar-bg    : #ae8912;

  --option-sel   : #fff;

  --correct-bg   : #113d2d; --correct-bd:#2aa15f;
  --wrong-bg     : #5b2028; --wrong-bd :#dc3545;
}

/* â€”â€” Ø£Ø³Ø§Ø³ÙŠØ§Øª â€”â€” */
*{box-sizing:border-box;margin:0;scroll-behavior:smooth}
body{font-family:'Times New Roman', Times, serif
,sans-serif;background:var(--bg);color:var(--text)}
/* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ */
.topbar{background:var(--topbar-bg);color:#fff;padding:.9rem 1.2rem;display:flex;align-items:center;gap:10px}
.topbar h1{font-size:1.2rem;margin:0 auto 0 0}
.back-btn{background:#ffffff26;border:none;color:#fff;padding:.2rem 1rem;border-radius:8px;cursor:pointer;font-size:.95rem}
.back-btn:hover{background:#ffffff40}
.theme-toggle{background:#ffffff26;border:none;color:#fff;border-radius:50%;width:34px;height:34px;cursor:pointer;font-size:1.1rem;display:flex;align-items:center;justify-content:center}
.theme-toggle:hover{background:#ffffff40}

/* Ù…Ø­ØªÙˆÙ‰ Ù…Ø±ÙƒØ²ÙŠ */
.container{max-width:700px;margin:auto;padding:24px}

/* Ø²Ø± Ø¹Ø§Ù… */
.btn{display:block;width:90%;max-width:520px;margin:12px auto;padding:.9rem;border:none;border-radius:12px;font-size:1.05rem;cursor:pointer;transition:.15s;box-shadow:0 2px 5px rgba(0,0,0,.1)}
.btn-main{background:var(--primary);color:#fff}
.btn-main:hover{background:var(--primary-hov)}
.btn-sec{background:var(--secondary);color:#fff}
.btn-sec:hover{background:var(--secondary-hov)}
.btn:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}

/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
.card{background:var(--card-bg);border-radius:12px;margin-top:20px;padding:1.3rem 1.4rem;box-shadow:0 2px 6px rgba(0,0,0,.08);direction:ltr;text-align:left;border:1.5px solid var(--card-border)}
.card h4{margin-bottom:.8rem;font-size:1.05rem}

/* Ø®ÙŠØ§Ø± */
.option{display:flex;align-items:center;border:2px solid var(--card-border);border-radius:10px;padding:.55rem .85rem;margin:.5rem 0;cursor:pointer;transition:.15s;font-size:.97rem}
.option input{margin-right:.6rem;cursor:pointer}
.option.selected{border-color:var(--option-sel)}
.option.correct{border-color:var(--correct-bd);background:var(--correct-bg)}
.option.wrong  {border-color:var(--wrong-bd);background:var(--wrong-bg)}

/* ØµÙ†Ø¯ÙˆÙ‚ Ù†ØªÙŠØ¬Ø© */
.result-box{max-width:520px;margin:0 auto 1.5rem;padding:1.2rem;border-radius:12px;text-align:center;font-size:1.1rem;font-weight:700;box-shadow:0 2px 6px rgba(0,0,0,.08)}
.pass{background:var(--correct-bg);color:var(--correct-bd)}
.fail{background:var(--wrong-bg);color:var(--wrong-bd)}
</style>

<body>
<!-- Ø´Ø±ÙŠØ· Ø£Ø¹Ù„Ù‰ -->
<div class="topbar">
  <button id="backBtn" class="back-btn" style="display:none" onclick="renderHome()">Ø±Ø¬ÙˆØ¹</button>
  <h1 id="barTitle">Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h1>
  <button id="themeBtn" class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
</div>

<div id="app" class="container"></div>

<script>
/* Ø±ÙˆØ§Ø¨Ø· JSON */
const COURSES={
  des   :{title:"Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/dess_quiz.json"},
  mobile:{title:"Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/mobApp_quiz.json"},
  iot   :{title:"Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø£Ø´ÙŠØ§Ø¡",
          src:"https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/iot_quiz.json"}
};

const tg = window.Telegram?.WebApp;
const app      = document.getElementById("app");
const barTitle = document.getElementById("barTitle");
const backBtn  = document.getElementById("backBtn");
const themeBtn = document.getElementById("themeBtn");

/* ============ Ø«ÙŠÙ… ============ */
function applyTheme(th){
   document.documentElement.setAttribute('data-theme',th);
   themeBtn.textContent = th==='dark'?'ğŸŒ':'ğŸŒ™';
}
function initTheme(){
   let th=localStorage.theme;
   if(!th){
      th = (tg && tg.themeParams?.bg_color === '#000000') ? 'dark' : 'light';
   }
   applyTheme(th);
}
function toggleTheme(){
   const cur=document.documentElement.getAttribute('data-theme')==='dark'?'dark':'light';
   const next=cur==='dark'?'light':'dark';
   localStorage.theme=next;
   applyTheme(next);
}
initTheme();

/* ============ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ============ */
let quizData=[],answers=[];

/* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
function renderHome(){
  backBtn.style.display="none";
  barTitle.textContent="Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª";
  app.innerHTML=`<h2 class="fw-bold mb-4" style="text-align:center">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>`+
    Object.entries(COURSES).map(([k,v])=>`<button class="btn btn-main" onclick="startQuiz('${k}')">${v.title}</button>`).join("");
}

function startQuiz(key){
  const {title,src}=COURSES[key];
  backBtn.style.display="inline-block";
  barTitle.textContent=title;
  app.innerHTML=`<div id="quiz"></div><button id="submit" class="btn btn-main mt-3" disabled>Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>`;
  fetch(src).then(r=>r.json()).then(d=>{quizData=d;renderQuestions();});
}

function renderQuestions(){
  const box=document.getElementById("quiz"); box.innerHTML="";
  quizData.forEach((q,i)=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`<h4>${i+1}. ${q.question}</h4>`+q.options.map((opt,idx)=>`
        <label class="option" id="lbl-${i}-${idx}">
          <input type="radio" name="q${i}" value="${idx}"> ${opt}
        </label>`).join("");
    box.appendChild(card);
  });
}

/* Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
document.addEventListener("change",e=>{
 if(e.target.type!=="radio")return;
 const name=e.target.name;
 document.querySelectorAll(`input[name="${name}"]`).forEach(inp=>{
   document.getElementById(`lbl-${name.slice(1)}-${inp.value}`).classList.toggle("selected",inp.checked);
 });
 const check=quizData.map((_,i)=>{const sel=document.querySelector(`input[name=q${i}]:checked`);return sel?Number(sel.value):null;});
 document.getElementById("submit").disabled = check.includes(null);
});

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆØ§Ù„ØªØµØ­ÙŠØ­ */
document.addEventListener("click",e=>{
 const id=e.target.id;
 if(id==="submit"){showScore();e.target.remove();addReviewButton();}
 else if(id==="reviewBtn"){showReview();e.target.remove();}
});

function showScore(){
 answers=quizData.map((_,i)=>Number(document.querySelector(`input[name=q${i}]:checked`).value));
 const score=answers.reduce((s,a,i)=> a===quizData[i].correct_option_id? s+1 : s ,0);
 const pass = score >= Math.ceil(quizData.length/2);
 const box  = document.createElement("div");
 box.className=`result-box ${pass?'pass':'fail'}`;
 box.innerHTML=pass?`Ù…Ø¨Ø±ÙˆÙƒ! Ø¯Ø±Ø¬ØªÙƒ <span>${score}</span> Ù…Ù† <span>${quizData.length}</span>`
                  :`Ø­Ø¸Ù‹Ø§ Ø£ÙˆÙØ±! Ø¯Ø±Ø¬ØªÙƒ <span>${score}</span> Ù…Ù† <span>${quizData.length}</span>`;
 app.prepend(box);
 addFooterButtons();
 window.scrollTo({top:0,behavior:"smooth"});
}

function addReviewButton(){
 app.insertAdjacentHTML("afterbegin",`<button id="reviewBtn" class="btn btn-sec mt-2">ğŸ” Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ­ÙŠØ­</button>`);
}

function showReview(){
 quizData.forEach((q,i)=>{
   const cor=q.correct_option_id;
   document.getElementById(`lbl-${i}-${cor}`).classList.add("correct");
   const user=answers[i];
   if(user!==cor){document.getElementById(`lbl-${i}-${user}`).classList.add("wrong");}
 });
 addFooterButtons();
 window.scrollTo({top:0,behavior:"smooth"});
}

/* Ø£Ø³ÙÙ„ Ø§Ù„ØµÙØ­Ø© */
function addFooterButtons(){
 if(document.getElementById("footerBtns"))return;
 app.insertAdjacentHTML("beforeend",`
   <div id="footerBtns" class="text-center mt-4">
     <button class="btn btn-main mb-2" onclick="renderHome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
     <button class="btn btn-sec"  onclick="tg?tg.close():window.close()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©</button>
   </div>`);
}

/* ØªØ´ØºÙŠÙ„ */
renderHome();
</script>
</body></html>
