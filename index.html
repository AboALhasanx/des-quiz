<!doctype html>
<html lang="ar" dir="rtl">
<meta charset="utf-8">
<title>ÙƒÙˆØ²Ø§Øª ÙˆØ§Ø®ØªØ¨Ø§Ø±Ø§Øª MCQ</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>

  *:focus{
  outline:none !important;      /* ÙŠØ²ÙŠÙ„ Ø§Ù„Ø®Ø· Ø§Ù„Ø£Ø²Ø±Ù‚ */
  box-shadow:none !important;   /* ÙŠØ²ÙŠÙ„ Ø¸Ù„Ù‘ Ø§Ù„ØªØ±ÙƒÙŠØ² Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø¹Ù†Ø§ØµØ± */
}

  /* ===== Ù„ÙˆØ­Ø© Ø§Ù„Ø«ÙŠÙ… (Ø±Ù…Ø§Ø¯ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„) ===== */
  :root[data-theme="light"] {
    --bg: #f4f4f4;
    --text: #212121;
    --card-bg: #ffffff;
    --card-border: #d7d7d7;

    --primary: #505050;
    /* Ø²Ø±Ù‘ Ø±Ø¦ÙŠØ³ÙŠ Ø±Ù…Ø§Ø¯ÙŠ Ø¯Ø§ÙƒÙ† */
    --primary-hov: #3e3e3e;

    --secondary: #7e7e7e;
    --secondary-hov: #6d6d6d;
    --topbar-bg: #3c3c3c;
    /* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ø±Ù…Ø§Ø¯ÙŠ ØºØ§Ù…Ù‚ */

    --grad-from: #e7e7e7;
    --grad-to: #cacaca;
    /* Ø®Ù„ÙÙŠØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ */
    --option-sel: #000;

    /* Ø§Ù„ØªØµØ­ÙŠØ­ ÙŠØ¨Ù‚Ù‰ Ù…Ù„ÙˆÙ‘Ù† */
    --correct-bg: #d1e7dd;
    --correct-bd: #198754;
    --wrong-bg: #f8d7da;
    --wrong-bd: #dc3545;
  }

  :root[data-theme="dark"] {
    --bg: #141414;
    --text: #eeeeee;
    --card-bg: #1f1f1f;
    --card-border: #404040;

    --primary: #707070;
    --primary-hov: #808080;
    --secondary: #535353;
    --secondary-hov: #636363;
    --topbar-bg: #2a2a2a;

    --grad-from: #2b2b2b;
    --grad-to: #494949;

    --option-sel: #fff;

    --correct-bg: #113d2d;
    --correct-bd: #2aa15f;
    --wrong-bg: #5b2028;
    --wrong-bd: #dc3545;
  }

  /* â€” Ø£Ø³Ø§Ø³ÙŠØ§Øª â€” */
  * {
    box-sizing: border-box;
    margin: 0;
    scroll-behavior: smooth
  }

  body {
    font-family: 'Times New Roman', Times, serif,
      sans-serif;
    background: var(--bg);
    color: var(--text)
  }

  /* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ø«Ø§Ø¨Øª */
  .topbar {
    background: var(--topbar-bg);
    color: #fff;
    padding: .9rem 1.2rem;
    display: flex;
    align-items: center;
    gap: 10px;
    position: sticky;
    top: 0;
    z-index: 1000
  }

  .topbar h1 {
    font-size: 1.2rem;
    margin: 0 auto 0 0
  }

  .back-btn {
    background: #ffffff26;
    border: none;
    color: #fff;
    padding: .25rem 1.1rem;
    border-radius: 8px;
    cursor: pointer;
    font-size: .95rem
  }

  .back-btn:hover {
    background: #ffffff3d
  }

  .theme-toggle {
    background: #ffffff26;
    border: none;
    color: #fff;
    border-radius: 50%;
    width: 34px;
    height: 34px;
    cursor: pointer;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center
  }

  .theme-toggle:hover {
    background: #ffffff3d
  }

  /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
  .hero {
    min-height: calc(100vh - 52px);
    padding: 32px;
    background: linear-gradient(135deg, var(--grad-from), var(--grad-to));
    display: flex;
    flex-direction: column;
    justify-content: center
  }

  .course-card {
    background: var(--card-bg);
    backdrop-filter: blur(6px);
    border-radius: 18px;
    border: 1px solid var(--card-border);
    width: 90%;
    max-width: 640px;
    margin: 18px auto;
    padding: 28px;
    display: flex;
    gap: 28px;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(0, 0, 0, .15);
    transition: .25s
  }

  .course-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 28px rgba(0, 0, 0, .25)
  }

  .card-thumb {
    flex: 0 0 120px;
    height: 120px;
    border-radius: 16px;
    background-size: cover;
    background-position: center
  }

  .card-body {
    flex: 1
  }

  .card-body h3 {
    margin-bottom: 6px;
    font-size: 1.15rem;
    font-weight: 700
  }

  .card-body p {
    font-size: .9rem;
    opacity: .8;
    margin: 0
  }

  /* Ø²Ø±Ù‘ Ø¹Ø§Ù… */
  .btn {
    display: block;
    width: 90%;
    max-width: 520px;
    margin: 12px auto;
    padding: .9rem;
    border: none;
    border-radius: 12px;
    font-size: 1.05rem;
    cursor: pointer;
    transition: .15s;
    box-shadow: 0 2px 5px rgba(0, 0, 0, .1)
  }

  .btn-main {
    background: var(--primary);
    color: #fff
  }

  .btn-main:hover {
    background: var(--primary-hov)
  }

  .btn-sec {
    background: var(--secondary);
    color: #fff
  }

  .btn-sec:hover {
    background: var(--secondary-hov)
  }

  .btn:disabled {
    opacity: .55;
    cursor: not-allowed
  }

  /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
  .card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 1.3rem 1.4rem;
    margin-top: 20px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, .08);
    direction: ltr;
    text-align: left;
    border: 1.5px solid var(--card-border)
  }

  .card h4 {
    margin-bottom: .8rem;
    font-size: 1.05rem
  }

  .option {
    display: flex;
    align-items: center;
    border: 2px solid var(--card-border);
    border-radius: 10px;
    padding: .55rem .85rem;
    margin: .5rem 0;
    cursor: pointer;
    transition: .15s;
    font-size: .97rem
  }

  .option input {
    margin-right: .6rem;
    cursor: pointer
  }

  .option.selected {
    border-color: var(--option-sel)
  }

  .option.correct {
    border-color: var(--correct-bd);
    background: var(--correct-bg)
  }

  .option.wrong {
    border-color: var(--wrong-bd);
    background: var(--wrong-bg)
  }

  /* Ù†ØªÙŠØ¬Ø© */
  .result-box {
    max-width: 520px;
    margin: 0 auto 1.5rem;
    padding: 1.2rem;
    border-radius: 12px;
    text-align: center;
    font-size: 1.1rem;
    font-weight: 700;
    box-shadow: 0 2px 6px rgba(0, 0, 0, .08)
  }

  .pass {
    background: var(--correct-bg);
    color: var(--correct-bd)
  }

  .fail {
    background: var(--wrong-bg);
    color: var(--wrong-bd)
  }

  footer {
    background: var(--card-bg);
    border-top: 1px solid var(--card-border);
    padding: 1rem 0;
    margin-top: 2rem;
  }

  footer .footer-container {
    max-width: 640px;
    margin: 0 auto;
    text-align: center;
  }

  footer .footer-text {
    font-size: 0.95rem;
    color: var(--secondary);
    margin-bottom: 0.5rem;
  }

  footer .footer-link {
    color: var(--primary);
    text-decoration: none;
    font-weight: 600;
    transition: color 0.2s ease;
  }

  footer .footer-link:hover {
    color: var(--primary-hov);
    text-decoration: underline;
  }

  footer .attribution {
    font-size: 0.85rem;
    color: var(--secondary);
    opacity: 0.7;
  }
</style>

<body>
  <div class="topbar">
    <button id="backBtn" class="back-btn" style="display:none" onclick="renderHome()">Ø±Ø¬ÙˆØ¹</button>
    <h1 id="barTitle">ÙƒÙˆØ²Ø§Øª ÙˆØ§Ø®ØªØ¨Ø§Ø±Ø§Øª MCQ</h1>
    <button id="themeBtn" class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
  </div>

  <div id="app"></div>

  <script>
    /* Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¯ */
    const COURSES = {
      des: {
        title: "Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©", desc: " ",
        img: "https://i.ibb.co/tMJfzZPP/1744451978496.png",
        src: "https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/dess_quiz.json"
      },
      mobile: {
        title: "Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„", desc: " ",
        img: "https://c0.wallpaperflare.com/preview/260/841/181/concept-development-device-flat.jpg",
        src: "https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/mobApp_quiz.json"
      },
      iot: {
        title: "Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø£Ø´ÙŠØ§Ø¡", desc: " ",
        img: "https://images.unsplash.com/photo-1555664424-778a1e5e1b48?q=80&w=2070&auto=format&fit=crop",
        src: "https://raw.githubusercontent.com/AboALhasanx/json-files/refs/heads/main/iot_quiz.json"
      }
    };

    const tg = window.Telegram?.WebApp;
    const app = document.getElementById("app"), barTitle = document.getElementById("barTitle"), backBtn = document.getElementById("backBtn"), themeBtn = document.getElementById("themeBtn");

    /* Ø§Ù„Ø«ÙŠÙ… */
    function applyTheme(th) { document.documentElement.setAttribute('data-theme', th); themeBtn.textContent = th === 'dark' ? 'ğŸŒ' : 'ğŸŒ™'; }
    applyTheme(localStorage.theme ?? ((tg && tg.themeParams?.bg_color) === '#000000' ? 'dark' : 'light'));
    function toggleTheme() { const th = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'; localStorage.theme = th; applyTheme(th); }

    let quizData = [], answers = [];

    /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
    function renderHome() {
      backBtn.style.display = "none"; barTitle.textContent = "ÙƒÙˆØ²Ø§Øª ÙˆØ§Ø®ØªØ¨Ø§Ø±Ø§Øª MCQ";
      app.innerHTML = '<section class="hero">' +
        Object.entries(COURSES).map(([k, v]) => `
       <div class="course-card" onclick="startQuiz('${k}')">
         <div class="card-thumb" style="background-image:url('${v.img}')"></div>
         <div class="card-body"><h3>${v.title}</h3><p>${v.desc}</p></div>
       </div>`).join("") +
        '</section>';
    }

    /* Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± */
    function startQuiz(key) {
      const { title, src } = COURSES[key]; backBtn.style.display = "inline-block"; barTitle.textContent = title;
      app.innerHTML = `<div class="container"><div id="quiz"></div><button id="submit" class="btn btn-main mt-3" disabled>Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©</button></div>`;
      fetch(src).then(r => r.json()).then(d => { quizData = d; renderQuestions(); });
    }
    function renderQuestions() {
      const box = document.getElementById("quiz"); box.innerHTML = "";
      quizData.forEach((q, i) => {
        box.insertAdjacentHTML("beforeend",
          `<div class="card"><h4>${i + 1}. ${q.question}</h4>` +
          q.options.map((opt, idx) => `
        <label class="option" id="lbl-${i}-${idx}">
          <input type="radio" name="q${i}" value="${idx}"> ${opt}
        </label>`).join("") +
          '</div>');
      });
    }

    /* Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
    document.addEventListener("change", e => {
      if (e.target.type !== "radio") return;
      const name = e.target.name;
      document.querySelectorAll(`input[name="${name}"]`).forEach(inp => {
        document.getElementById(`lbl-${name.slice(1)}-${inp.value}`).classList.toggle("selected", inp.checked);
      });
      const filled = quizData.every((_, i) => document.querySelector(`input[name=q${i}]:checked`)); document.getElementById("submit").disabled = !filled;
    });

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
    document.addEventListener("click", e => {
      if (e.target.id === "submit") { showScore(); e.target.remove(); document.querySelector('.container').insertAdjacentHTML("afterbegin", `<button id="reviewBtn" class="btn btn-sec mt-2">ğŸ” Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ­ÙŠØ­</button>`); }
      if (e.target.id === "reviewBtn") { showReview(); e.target.remove(); }
    });

    function showScore() {
      answers = quizData.map((_, i) => Number(document.querySelector(`input[name=q${i}]:checked`).value));
      const score = answers.reduce((s, a, i) => a === quizData[i].correct_option_id ? s + 1 : s, 0);
      const pass = score >= Math.ceil(quizData.length / 2);
      document.querySelector('.container').insertAdjacentHTML("afterbegin",
        `<div class="result-box ${pass ? 'pass' : 'fail'}">${pass ? 'Ù…Ø¨Ø±ÙˆÙƒ' : 'Ø­Ø¸Ù‹Ø§ Ø£ÙˆÙØ±'}! Ø¯Ø±Ø¬ØªÙƒ <span>${score}</span> Ù…Ù† <span>${quizData.length}</span></div>`);
      addFooter();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
    function showReview() {
      quizData.forEach((q, i) => {
        const c = q.correct_option_id; document.getElementById(`lbl-${i}-${c}`).classList.add("correct");
        const u = answers[i]; if (u !== c) document.getElementById(`lbl-${i}-${u}`).classList.add("wrong");
      });
      addFooter(); window.scrollTo({ top: 0, behavior: "smooth" });
    }
    function addFooter() {
      if (document.getElementById("footerBtns")) return;
      document.querySelector('.container').insertAdjacentHTML("beforeend",
        `<div id="footerBtns" class="text-center mt-4">
      <button class="btn btn-main mb-2" onclick="renderHome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
      <button class="btn btn-sec" onclick="tg?tg.close():window.close()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©</button>
    </div>`);
    }

    /* ØªØ´ØºÙŠÙ„ */
    renderHome();
  </script>
  <footer>
    <div class="footer-container">
      <p class="footer-text">
        Ø´ÙƒØ±Ù‹Ø§ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ ØªØ·Ø¨ÙŠÙ‚ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª MCQ Ù…Ù† Ø¨ÙˆØª Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©
      </p>
      <p class="footer-text attribution">
        ØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø©
        <a href="https://t.me/ab0_alhasan" target="_blank" class="footer-link">Ø§Ø¨Ù€ÙˆØ§Ù„Ù€Ø­Ø³Ù†</a>
      </p>
    </div>
  </footer>
</body>

</html>
